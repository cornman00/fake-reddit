{"ast":null,"code":"import _defineProperty from\"/Users/seokhyunkim/Desktop/projects/fake_reddit/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/seokhyunkim/Desktop/projects/fake_reddit/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/seokhyunkim/Desktop/projects/fake_reddit/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import axios from\"axios\";import\"../../App.scss\";import{Button,Modal,ModalHeader,ModalBody}from\"reactstrap\";import GoogleLogin from\"react-google-login\";var LoginModal=function LoginModal(_ref){var updateToken=_ref.updateToken,logModalToggle=_ref.logModalToggle,logModal=_ref.logModal;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState({username_error:\"\",password_error:\"\"}),_useState6=_slicedToArray(_useState5,2),errors=_useState6[0],setErrors=_useState6[1];var handleSubmit=function handleSubmit(e){var isValid=formValidate();e.preventDefault();if(isValid){axios.post(\"/api/login\",{username:username,password:password}).then(function(res){return res.data;}).then(function(data){if(\"error_message\"in data){setErrors(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},\"password_error\",data.error_message));});}else{logModalToggle();localStorage.setItem(\"userToken\",data.access_token);localStorage.setItem(\"username\",data.username);updateToken();window.location.reload();}}).catch(function(err){logModalToggle();alert(\"Sign up failed. Please try again\");console.log(err);});}};var formValidate=function formValidate(){var isValid=true;setErrors({});if(!username){setErrors(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},\"username_error\",\"Empty Username\"));});isValid=false;}else if(username.length<=4||username.length>=21){setErrors(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},\"username_error\",\"The length of username should be between 5 and 20.\"));});isValid=false;}if(!password){setErrors(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},\"password_error\",\"Empty Password\"));});isValid=false;}return isValid;};var googleOnSuccess=function googleOnSuccess(res){console.log(res);var userEmail=res.profileObj.email;var parsed_username=userEmail.substring(0,userEmail.indexOf(\"@\"));setUsername(parsed_username);localStorage.setItem(\"userToken\",res.tokenObj.access_token);localStorage.setItem(\"username\",parsed_username);updateToken();alert(\"Logged In Successfully\");};var googleOnFailure=function googleOnFailure(res){console.log(res);};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Modal,{className:\"auth-modal\",isOpen:logModal,toggle:logModalToggle},/*#__PURE__*/React.createElement(ModalHeader,{className:\"modal-header\",toggle:logModalToggle},\"Log in\"),/*#__PURE__*/React.createElement(ModalBody,{className:\"modal-body\"},/*#__PURE__*/React.createElement(GoogleLogin,{clientId:\"1087910724182-02v9tf6jm6h867i3vd81rui2dm4b6jvb.apps.googleusercontent.com\",render:function render(renderProps){return/*#__PURE__*/React.createElement(Button,{onClick:renderProps.onClick,disabled:renderProps.disabled,color:\"link\",className:\"google-button\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fab fa-google\"}),\"CONTINUE WITH GOOGLE\");},onSuccess:googleOnSuccess,onFailure:googleOnFailure,cookiePolicy:\"single_host_origin\"}),/*#__PURE__*/React.createElement(\"form\",{method:\"POST\",onSubmit:handleSubmit,noValidate:true},/*#__PURE__*/React.createElement(\"div\",{className:\"input-buttons-wrapper\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"username\",placeholder:\"USERNAME\",onChange:function onChange(e){return setUsername(e.target.value);},required:true}),/*#__PURE__*/React.createElement(\"div\",{className:\"error-message\"},errors[\"username_error\"]),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",name:\"password\",placeholder:\"PASSWORD\",onChange:function onChange(e){return setPassword(e.target.value);},required:true}),/*#__PURE__*/React.createElement(\"div\",{className:\"error-message\"},errors[\"password_error\"])),/*#__PURE__*/React.createElement(Button,{type:\"submit\",className:\"modal-login-button\",color:\"primary\"},\"LOG IN\")))));};export default LoginModal;","map":{"version":3,"sources":["/Users/seokhyunkim/Desktop/projects/fake_reddit/client/src/components/navbar/LoginModal.js"],"names":["React","useState","axios","Button","Modal","ModalHeader","ModalBody","GoogleLogin","LoginModal","updateToken","logModalToggle","logModal","username","setUsername","password","setPassword","username_error","password_error","errors","setErrors","handleSubmit","e","isValid","formValidate","preventDefault","post","then","res","data","prev","error_message","localStorage","setItem","access_token","window","location","reload","catch","err","alert","console","log","length","googleOnSuccess","userEmail","profileObj","email","parsed_username","substring","indexOf","tokenObj","googleOnFailure","renderProps","onClick","disabled","target","value"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport axios from \"axios\";\nimport \"../../App.scss\";\nimport { Button, Modal, ModalHeader, ModalBody } from \"reactstrap\";\nimport GoogleLogin from \"react-google-login\";\n\nconst LoginModal = ({ updateToken, logModalToggle, logModal }) => {\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [errors, setErrors] = useState({\n    username_error: \"\",\n    password_error: \"\",\n  });\n\n  const handleSubmit = (e) => {\n    const isValid = formValidate();\n    e.preventDefault();\n    if (isValid) {\n      axios\n        .post(\"/api/login\", {\n          username: username,\n          password: password,\n        })\n        .then((res) => res.data)\n        .then((data) => {\n          if (\"error_message\" in data) {\n            setErrors((prev) => ({\n              ...prev,\n              [\"password_error\"]: data.error_message,\n            }));\n          } else {\n            logModalToggle();\n            localStorage.setItem(\"userToken\", data.access_token);\n            localStorage.setItem(\"username\", data.username);\n            updateToken();\n            window.location.reload();\n          }\n        })\n        .catch((err) => {\n          logModalToggle();\n          alert(\"Sign up failed. Please try again\");\n          console.log(err);\n        });\n    }\n  };\n\n  const formValidate = () => {\n    let isValid = true;\n    setErrors({});\n\n    if (!username) {\n      setErrors((prev) => ({\n        ...prev,\n        [\"username_error\"]: \"Empty Username\",\n      }));\n      isValid = false;\n    } else if (username.length <= 4 || username.length >= 21) {\n      setErrors((prev) => ({\n        ...prev,\n        [\"username_error\"]:\n          \"The length of username should be between 5 and 20.\",\n      }));\n      isValid = false;\n    }\n\n    if (!password) {\n      setErrors((prev) => ({\n        ...prev,\n        [\"password_error\"]: \"Empty Password\",\n      }));\n      isValid = false;\n    }\n\n    return isValid;\n  };\n\n  const googleOnSuccess = (res) => {\n    console.log(res);\n    const userEmail = res.profileObj.email;\n    const parsed_username = userEmail.substring(0, userEmail.indexOf(\"@\"));\n    setUsername(parsed_username);\n    localStorage.setItem(\"userToken\", res.tokenObj.access_token);\n    localStorage.setItem(\"username\", parsed_username);\n    updateToken();\n    alert(\"Logged In Successfully\");\n  };\n\n  const googleOnFailure = (res) => {\n    console.log(res);\n  };\n\n  return (\n    <div>\n      <Modal className=\"auth-modal\" isOpen={logModal} toggle={logModalToggle}>\n        <ModalHeader className=\"modal-header\" toggle={logModalToggle}>\n          Log in\n        </ModalHeader>\n        <ModalBody className=\"modal-body\">\n          <GoogleLogin\n            clientId=\"1087910724182-02v9tf6jm6h867i3vd81rui2dm4b6jvb.apps.googleusercontent.com\"\n            render={(renderProps) => (\n              <Button\n                onClick={renderProps.onClick}\n                disabled={renderProps.disabled}\n                color=\"link\"\n                className=\"google-button\"\n              >\n                <i className=\"fab fa-google\"></i>\n                CONTINUE WITH GOOGLE\n              </Button>\n            )}\n            onSuccess={googleOnSuccess}\n            onFailure={googleOnFailure}\n            cookiePolicy={\"single_host_origin\"}\n          />\n          <form method=\"POST\" onSubmit={handleSubmit} noValidate>\n            <div className=\"input-buttons-wrapper\">\n              <input\n                type=\"text\"\n                name=\"username\"\n                placeholder=\"USERNAME\"\n                onChange={(e) => setUsername(e.target.value)}\n                required\n              />\n              <div className=\"error-message\">{errors[\"username_error\"]}</div>\n              <input\n                type=\"password\"\n                name=\"password\"\n                placeholder=\"PASSWORD\"\n                onChange={(e) => setPassword(e.target.value)}\n                required\n              />\n              <div className=\"error-message\">{errors[\"password_error\"]}</div>\n            </div>\n            <Button\n              type=\"submit\"\n              className=\"modal-login-button\"\n              color=\"primary\"\n            >\n              LOG IN\n            </Button>\n          </form>\n        </ModalBody>\n      </Modal>\n    </div>\n  );\n};\n\nexport default LoginModal;\n"]},"metadata":{},"sourceType":"module"}